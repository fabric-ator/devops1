this code is by mark
